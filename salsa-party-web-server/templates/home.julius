function geoFindMe() {

  const address = document.querySelector('#queryInput');
  const status = document.querySelector('#find-me');


  function success(position) {
    console.log(position)
    const latitude  = position.coords.latitude;
    const longitude = position.coords.longitude;

    address.placeholder = #{messageRender MsgHomeFormLocation};
    status.textContent = #{messageRender MsgHomeFormLocationDone};
    status.classList.add("is-dark");
    status.disabled = true;

    document.querySelector('#queryInput').required = false;
    document.querySelector('#latitudeInput').value = latitude;
    document.querySelector('#longitudeInput').value = longitude;
    document.querySelector('#help').innerText = #{messageRender MsgHomeFormHelp};
  }

  function error(err) {
    console.log(err)
    status.textContent = #{messageRender MsgHomeFormLocationUnable};
    status.classList.add("is-danger");
  }

  if(!navigator.geolocation) {
    status.textContent = #{messageRender MsgHomeFormLocationNotSupported};
  } else {
    status.textContent = #{messageRender MsgHomeFormLocationInProgress};
    navigator.geolocation.getCurrentPosition(success, error);
  }

}

document.querySelector('#find-me').addEventListener('click', geoFindMe);


document.addEventListener("DOMContentLoaded", function() {
  navigator.permissions.query({name: 'geolocation'}).then(function(result) { 
    if (result.state == 'granted') {
      geoFindMe();
    };
})});

